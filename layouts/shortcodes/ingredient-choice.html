{{- $id := .Get "id" -}}
{{- $note := .Get "note" | default "" -}}
{{- $optional := .Get "optional" | default false -}}

{{- /* Collect refs from inner options to check for global alternatives */ -}}
{{- $scratch := newScratch -}}
{{- $scratch.Set "globalAlts" slice -}}

<li class="ingredient ingredient-choice"
    id="ingredient-{{ $id }}"
    data-ingredient-id="{{ $id }}">
  <div class="ingredient-main">
    <span class="ingredient-amount"></span>
    <span class="ingredient-unit"></span>
    <select class="ingredient-select" aria-label="Ingredient choice">
      {{ .Inner }}
      {{- /* Global alternatives are added via option shortcode data attributes */ -}}
    </select>
    {{- if $note -}}<span class="ingredient-note">({{ $note }})</span>{{- end -}}
    {{- if $optional -}}<span class="ingredient-optional">(optional)</span>{{- end -}}
  </div>
  <div class="posthof-info posthof-choice-info"></div>
</li>
